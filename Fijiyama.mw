{{Infobox
| software               = Fiji
| name                   = Fijiyama
| author                 = Romain Fernandez & CÃ©dric Moisy
| maintainer             = Romain Fernandez
| filename               = Fijiyama.jar
| source                 = {{GitHub|repo=repo_a_mettre}}
| released               = February 11<sup>th</sup>, 2010
| latest version         = February 11<sup>th</sup>, 2010
| status                 = stable, active
| category               = [[:Category:Registration|Registration]]
}}Fijiyama (Yet Another Matching and Alignment tool for Fiji) is a tool for registration and alignment of 3d images of the same object, acquired with different imaging tools (MRI, X-rays, Microscopy, Photography, ...) and/or at successive observation timepoints.

==Problem position==
When acquired with various imaging devices, 3d images can be hard to compare : Images from various devices come with variable orientations and positions. The problem is the same when a tissue cannot stay in the device during long-lasting monitoring experiment. Finally, different modalities highlights different structures, and can make images very dissimilar. In this situation, structures and phenomenons cross-analysis in the different images can be untractable.  

To handle these issues, Fijiyama helps you to register, align and combine all these data under a common reference geometry, aligned with the image axis (X,Y,Z), improving further visual analyses and figures. As opposed to existing tools under ImageJ, Fijiyama is well-suited to medical images (MRI / X-rays registration), but work also with more common laboratory images : microscopy, photograph. 

Once alignment is done, your images are not anymore a sparse set of informations, but a coherent multi-modal multi-time volume that you can explore easily with the ImageJ viewer, wearing different "glasses" (RX, MRI, ...) and changing observation time with one click.

Alignment computation is based on Block-matching registration, an algorithm from the medical imaging world, developed to adress the complex task of multi-modal registration. Other algorithms are available in the plugin (Itk iconic registration). More about the algorithmic bases of the plugin ? See section "The maths behind", bottom of the page.

Image sympa 1

Image sympa 2

Image sympa 3

==Plugin features==

* Two images registration (training / settings mode)

* N-times / M-modalities 3d series registration (main feature)

* Composition of successives Itk transforms into a single transform

* Transformation of a 3d image (or a 4d / 5d hyperimage) with an Itk transform

===Video demonstration===
See the plugin in action in this video :

{{#widget:YouTube|id=pouetpouet}}

==Getting started with Fijiyama==
===Installation===
Add the plugin to your current Fiji distribution : start the Fiji updater (Help/Update/Manage update sites...), activate the repositories ImageJ-Itk and ImageScience, then add the Fijiyama repository, hosted on the ImageJ server (Blabla blabla lien)

===Prepare your data===
In order to begin with the training mode, you need :
* Two 3d images of the same object. Use your own data, or the provided example dataset here (blablalien cerveau blablalien bouture).
* A place to build an empty "Output" directory, that will be used to store the Fijiyama configuration file, the intermediate results (transforms) and the final results (transforms and images). The configuration file (*.fjm) keep a full track of your work. When you save the current registration experiment, the configuration stores successive registration steps and the associated computed files. When restarting later from this point, you can review the whole process, and eventually "undo" one or more actions.

===Training : two image registration===
Start Fijiyama from the "Plugins" menu of ImageJ. Click on "Two images registration", then follow the instructions to set the input images and the output directory. Once the registration manager opens, explore the manager, reading the "tooltips" pop-ups, the contextual help, and clicking the buttons and menus, until you feel comfortable to begin. 

The registration manager window has four parts (top to bottom):
* Black log window : a guide to remember last operations, and to understand what the plugin expect from you

* Settings menus and buttons : useful to set the parameters of the future action to run

* Action buttons : the first line (<b>Run</b>, <b>Undo</b>, <b>Abort</b>) drives the lifecycle of the selected action. <b>Save</b> can be used to "checkpoint" the experiment. <b>Export</b> is the end of the experiment : it produces the results as aligned image, according with the succession of transforms you compute. <b>Sos</b> can be pushed at any time and opens a help message, constituted of a fixed part, and a contextual part, depending on current configuration of the plugin. 
* Actions list : this list stores the past (or future) actions on the registration pathway


The resulting files ...blabla

===Multimodal time-serie registration===

[[File:img.png]]


===Compose transforms===
Bla

===Apply transform to 3d/4d/5d Image===
Bla

== The maths behind ==
Registration of two images is achieved estimating a geometrical transform that can be applied to an image (the "moving one"), to superimpose it with another image (the "reference" one).

The Itk iconic algorithm optimizes iteratively a transform, tracking the superposition improvement using a global similarity measure between the two images.
The Block-Matching algorithm (reference) is an hybrid method : it applies a similarity measure to compare subparts of images to identify correspondances. The correspondance are then used to compute a global transform.

== Citing this work ==
R. Fernandez and C. Moisy, Fijiyama : a versatile registration tool for 3D multimodal time-lapse monitoring of biological tissues in Fiji (under review)

* {{Publication | Fijiyama}}

== License ==
This program is '''free software'''; you can redistribute it and/or modify it under the terms of the '''GNU General Public License''' as published by the Free Software Foundation ([http://www.gnu.org/licenses/gpl.txt http://www.gnu.org/licenses/gpl.txt]).

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  
----
[[Category:Plugins]]
[[Category:Registration]]
[[Category:Citable]]
