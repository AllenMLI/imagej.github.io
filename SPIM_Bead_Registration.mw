{{Infobox Plugin
| name                   = Selective Plane Illumination Microscopy Bead-based Registration
| software               = ImageJ
| author                 = Stephan Preibisch, Stephan Saalfeld, Johannes Schindelin, Pavel Tomancak
| maintainer             = Stephan Preibisch
| filename               = SPIM_Registration.jar
| released               = February 2010
| latest version         = October 2011
| category               = [[:Category:Registration|SPIM Registration]]
| website                = [http://fly.mpi-cbg.de/~preibisch Stephan Preibisch's homepage]
}}

== Citation ==
Please note that the SPIM registration plugin available through Fiji, is based on a publication. If you use it successfully for your research please be so kind to cite our work:
* S. Preibisch, S. Saalfeld, J. Schindelin and P. Tomancak (2010) "Software for bead-based registration of selective plane illumination microscopy data", ''Nature Methods'', '''7'''(6):418-419. [http://www.nature.com/nmeth/journal/v7/n6/full/nmeth0610-418.html Webpage] [[Media:Nmeth0610-418.pdf|PDF]] [[Media:Nmeth0610-418-S1.pdf|Supplement]]

For technical details about the registration method and SPIM imaging see [[SPIM Registration Method]].

== Introduction ==

Selective Plane Illumination Microscopy (SPIM, [http://www.sciencemag.org/content/305/5686/1007 ''Science'', '''305'''(5686):1007-9]) allows ''in toto'' imaging of large specimens by acquiring image stacks from multiple angles. We developed an algorithm for registration of multi-angle SPIM acquisitions using fluorescent beads in rigid mounting medium as fiduciary markers. The beads are matched by invariant, local geometric point descriptors and their displacement is minimized for globally optimal, sample-independent registration. The matching is computed very efficiently using a variation of geometric hashing reducing the matching problem to logarithmic complexity; the computation of the registration for a time point on a single computer takes less time than it takes to acquire the images making it suitable for real-time use. The framework can also be applied to register time-points to each other thus providing optimal alignment of time series.

The developed bead-based registration framework is able to reconstruct long-term, time-lapse, multi-view acquisitions of developing samples with yet unattainable temporal and spatial resolution allowing new insights into the development of biological specimen.

== Overview of the SPIM bead-based registration plugin ==

'''''Please note:''''' ''the bead-based registration has been rewritten and now replaces the "old" plugin collection (Registration, Advanced Registration, MultiChannel Registration) which has been moved to the deprecated folder. For information regarding these outdated plugins please refer to this [[SPIM_Bead_Registration_(deprecated)|page]].''

The bead-registration plugins offers two registration options:

* Single-channel
* Multi-channel (same beads are visible in different channels)

The typical option is single-channel registration, even if you want to process a multi-channel acquisitions. You can apply the registration of one channel later to other channels in the [[multi-view fusion plugin]]. Multi-channel registration is only required if the '''same beads''' are visible in several channels. 

Both options work in the exactly same way and have very similar options. The additional options of multi-channel registration are explained in the last section.

'''''Important note:''' the output of the plugin are not images, but only registration matrices that serve as basis for either the [[multi-view fusion plugin]] or the [[multi-view deconvolution plugin]].''

== How to use the plugin ==

[[Image:Spim beads singlechannel.jpg|thumb|260px|Shows the dialog for the bead-based registration]]

* '''SPIM Data Directory''': Fill in the directory name that contains all the image files. You can either drag&drop the directory, browse for it or type the name directly.

* '''Time Points to process''': Define the timepoint(s) that should be processed. You can give single numbers (e.g. 18), enumerate (e.g. 1, 18, 19, 100), define ranges (e.g. 1-18) or combine all of them in any combination wanted (e.g. 1,2,10,20-50).

* '''Pattern of SPIM files''': Define the naming convention of the input files by explaining how the angle and the timepoint is encoded into the filename. For example the file names are named in following way <br>''spim_tl1_angle0.lsm'', ''spim_tl1_angle45.lsm'' ... ''spim_tl1_angle270.lsm''<br>''spim_tl2_angle0.lsm'', ... ''spim_tl2_angle270.lsm''<br>''spim_tl100_angle0.lsm'', ... ''spim_tl100_angle270.lsm''.<br> That means the pattern of the file names corresponds to '''spim_tl{t}_angle{a}.lsm''', where '''{t}''' is replaced with the current timepoint and '''{a}''' with the current angle. If the numbers contain leading zeros (e.g. 000, 045, 090, 135 instead of 0, 45, 90, 135), this can be encoded by simply adding more letters to the placeholder, in this case '''{aaa}'''.

* '''Angles to process''': Define the angles (at least 2) that should be processed (for each timepoint if applicable). You can enumerate angles (e.g. 0, 90, 180, 270), define ranges in steps (e.g. 0-270:45 which means use angle 0 to 270 in steps of 45, i.e. 0, 45, 90, 135, 180, 225, 270) or combine all of them in any combination wanted (e.g. 0, 45, 180-270:45).

* '''Timelapse processing''': Checked if a timelapse processing should be performed. In this case the '''pre-registered''' timepoints are re-registered to one reference timepoint which results in an aligned time series.

* '''Reference Timepoint''': Define the reference timepoint for timelapse processing if timelapse processing above is checked.

* '''Load segmented beads''': If the registration of the time point is carried out more than once (to recompute the registration) the initial segmentation of the beads can be loaded to speed up processing. Note: if '''Load registration''' is checked, '''Load segmented beads''' is implicitly checked as well.

* '''Bead Brightness''': Define the brightness of the used beads relative to the sample.

* '''Load Registration''': If the registration of the time point is carried out more than once (either to define the correct cropping area or to perform timelapse processing) the initial segmentation of the beads and the final affine matrices of the views can be loaded to speed up processing. Note: if '''Load registration''' is checked, '''Load segmented beads''' is implicitly checked as well and '''Display registration''' will be ignored.

* '''Register only (no fusion)''': Checked if no fusion of the data should be performed.
