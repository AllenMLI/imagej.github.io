Suppose you are given some images by as colleague, or have some images of your own, and you want to measure the amount of colocalization between two of the dyes or stains in the images. First you have to define what you mean by colocalization, and that is not trivial. One place to start reading about coloclaization is here: [https://info.med.tu-dresden.de/MTZimaging/images/2/25/White_QuantitativeColocAnalysis0408a.pdf QuantitativeColocAnalysis] and for how to correctly capture quantitative fluorescence microscopy images suitable for colocalization analysis, look here: [https://info.med.tu-dresden.de/MTZimaging/images/6/63/White_QuantitativeColocAnalysis0408b.pdf Quantitative Imaging]

Also you should read these 2 papers very carefully: [[Image:Manders.pdf]] and [[Image:Costes etalColoc.pdf]], since we are going to use these methods for the analysis in this tutorial. Don't be scared by the maths, its actually very simple :-)

First lets open a sample data set that we know should have very good colocalization because the 2 subunits of a dimeric protein are dyes with green and red dyes respectively. The methods of Manders and Costes should work very well for this sample, but maybe we can see some problems with the data? Maybe we can get an idea of if the data is good for this analysis or not? 

'''Open this sample data file [http://pacific.mpi-cbg.de/samples/colocsample1bRGB_BG.tif colocsample1bRGB_BG.tif].''' Then use the "Image-Color-Split Channels" menu command to get a separate z stack for the 2 dyes (you can throw the blue one away!).

If you like, you can change the look up tables of the images (LUTs) so one is "green" and one is "red". Of course the colours here are always false, and only useful to use as apes with trichomatic vision to tell which channel is which: We are evolved to find red fruit in green trees. The detectors we use only see photons, and don't know what colour they are... that is determined by the fluorescence emission filters we use. There is no such thing as a green dye or a red dye, since they have broad emission spectra not a single wavelength corresponding to a certain "colour". 

[[Image:SplitChannels.png|300px]]

To Begin with, we should check the images for problems that might make the colocalisation analysis methods fail or be unreliable. We should looks for wrong offset / high background (as this confuses the auto threshold method, since zero signal is not zero pixel intensity but some larger number, see below), clipping/saturation (pixel intensity correlation measurements rely on the pixel intensities being true and not clipped to 255 when they were really higher!). We did this in the [[DetectInformationLoss]] tutorial, so do that first if you didn't already!  

Are the images spatially calibrated? If not then we need to calibrate them so we know how the spatial sampling rate (think pixel or voxel size) in x, y and z. See the [[SpatialCalibration]] tutorial for how to do that. We need the images to be spatially calibrated in order for the Costes statistical significance test (below) method to work properly, 

We need to think carefully about the correct or adequate spatial resolution in x, y and probably z. This depends on the [http://en.wikipedia.org/wiki/Numerical_aperture Numerical Aperture] of the objective lens at the high resolution limit (bigger NA, higher spatial resolution the lens can see and you can digitise, or on the smallest size of the objects you are interested in.

[http://en.wikipedia.org/wiki/Nyquist–Shannon_sampling_theorem Nyqvist] tells us the spatial sampling should be about three times smaller then the smallest object we want to resolve. Remember, spatial intensity correlation analysis, as we will perform here, can not tell you that 2 proteins are bound together in some biophysical bonding interaction... rather, it might suggest that the 2 molecules occur with the same relative amounts when they are present the set of spatial samples (pixels or voxels) above the thresholds we will calculate below. However, it is a hint in the "maybe they are binding partners or in the same macromolecular complex" direction, and you SHOULD follow up by determining true binding using [http://en.wikipedia.org/wiki/FLIM FLIM], [http://en.wikipedia.org/wiki/Förster_resonance_energy_transfer FRET] and biochemical methods like Immuno co-Precipitation etc.



There is another (badly behaved) sample file here which we will use later: [http://pacific.mpi-cbg.de/samples/150707_WTstack.lsm 150707_WTstack.lsm].


'''Colocalization Analysis - Using the methods of Manders and Costes, for spatial intensity correlation analysis, automatic thresholding and statistical significance testing.'''


<ol>
<li>
'''[[Colocalization Threshold]] plugin:''' 

<p>
This plugin performs several functions for you in one go. With the "green" and "red" stacks of the [http://pacific.mpi-cbg.de/samples/colocsample1bRGB_BG.tif colocsample1bRGB_BG.tif] dataset open and the channels split (see above) choose the menu item "Analyze-Colocalization-Colocalization Threshold". Next select the right stacks for the analysis in Channel1 and Channel2, You can use a region of interest (ROI) if you like, which should be defined before you run the plugin. Check on "Show Colocalized Pixels" and "Show Scatter Plot", and others off. You can explore the options in Set options. Turn ALL the option son the first time you use it, so you see what it can do. 
</p>

<p>
[[Image:Coloc1.png|300px]]
[[Image:Coloc1b.png|300px]]
[[Image:Coloc2.png|300px]]
<\p>

<ol>

<li>
It generates a 2D Histogram / Scatterplot / Fluorogram. this is a really good way to visualise the correlation of the pixel intensities, over all pixels/voxels in the image, and can tell you immediately about problems such as intensity saturation/clipping, wrong offset, emission bleedthrough (fluorescence signal from the wrong dye in the detection channel), and even if there are multiple populations of coloclaizing species with different ratios of dyes in the same sample. Think of it just like a FACS or Flow cytometry scatter plot; indeed it is very similar.
</li>

<li>
It makes a linear regression fit of the data in the scatter plot. That is the diagonal white line in the scatter plot, the gradient of which is the ratio of the intensities of the 2 channels. 
</li>

<li>
It does the Costes method auto threshold determination. The thresholds are the intensity levels above which for both channels you say the two dyes are "colocalized". This method uses an iterative procedure to determine what pair of thresholds for the 2 channels of the scatterplot give a [http://en.wikipedia.org/wiki/Correlation Pearson's correlation coefficient (r)] of zero for the pixels below the thresholds. That means that all the pixels which have intensities above the two thresholds have greater than zero correlation, and the pixels below the thresholds have none or anti correlated intensities. The method is pretty robust (so long as you don't stupidly defeat it, ie. with image data with high offsets / background), and is fully reproducible, meaning you will always get the same thresholds for the same data set, and similar thresholds for similar datasets. Threshold setting is a big problem in colocalization analysis. If you use a tool that allows you to manually set the thresholds, obviously you can get any result you like, since you are subjectively deciding what is colocalized and what isn't. This might please your boss, but it's not very scientific is it? So don't do that! Use the Costes auto threshold instead! Some people say the Costes method sets the thresholds too low, and lower than they would set them by eye. That might be true, but manual methods are subjective and totally unreliable. THe thresholds that Costes method sets always mean the correlation below the thresholds is zero. Thats a good thing. 
</li>

<li>
The plugin finally sends a bunch of statistics and results to the resutls window. You need to tuen them all on using the "set options" checkbox of the plugin GUI. Some of these resutls are pretty uninformative, but the most useful ones are:

<ol>

<li>
The thresholds that were set by the Costes Auto threshold method. 
</li>

<li>
</li>

<li>
</li>

<li>
</li>
</ol>

</li>

</ol>

</p>



</li>
Costes methods for StatcSignif. relies on the calibration to calculate how many pixels the [http://en.wikipedia.org/wiki/Point_spread_function point spread function] covers
<li>


<p>
</p>

<p>

</p>


</li>

<li>
<p>

</p>

<p> 

</p>

<p>

</p>

</li>

</ol>

----

Questions you should ask before attempting colocalization analysis from 2 colour channel images:

*Q) Has there been lossy compression?
*Q) Is the intensity information saturated / clipped / overexposed?
*Q) Is there a problem with uniform background / detector offset?



[[Category:Tutorials]]
[[Category:Color processing]]
