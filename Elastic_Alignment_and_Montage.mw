{{Infobox Plugin
| name                   = Elastic Align and Montage
| software               = Fiji
| author                  = [[User:Saalfeld|Stephan Saalfeld]] ([mailto:saalfeld@mpi-cbg.de])
| maintainer             = [[User:Saalfeld|Stephan Saalfeld]]
| source                 = [http://pacific.mpi-cbg.de/cgi-bin/gitweb.cgi?p=mpicbg.git;a=tree;f=mpicbg/ij/plugin]
| released               = March 11<sup>th</sup>, 2011
| latest version         = March 11<sup>th</sup>, 2011
| status                 = experimental, active
| category               = [[:Category:Plugins|Plugins]], [[:Category:Registration|Stitching]]
}}
The plugins '''Elastic Stack Alignment''' and '''Elastic Montage''' implement automatic elastic registration of 2d-images.  The applications are:

# montaging mosaics from overlapping tiles where the tiles have non-linear relative deformation
# alignment of deformed section series from serially sectioned volumes

Images are warped such that corresponding regions overlap optimally.  The warp for each single image is calculated such that each image in the whole global montage or series will be deformed minimally.  That way, arbitrarily large series of images can be aligned without accumulating artificial warps.

We achieve this globally minimized deformation by simulating the alignment as an elastic system of spring connected vertices.  Each vertex is connected to neighboring vertices in the image and thus prefers a rigid transformation of the image (or a flip, but to that later).  For some of the vertices, a corresponding location in overlapping images can be found.  In that case, this vertex is dragged by another spring into that location.  That is, springs between vertices and corresponding locations in other images try to deform an image whereas those within the image drag the image toward locally rigid transformation.

[[Image:Correlation.png|thumb|right|361px|Fig.1: Match filter based on the correlation surface. Starting from an approximate alignment (e.g. affine), for each vertex of the spring mesh, an offset is searched calculating the PMCC coefficient r of a block at all possible x,y translations in a given local vicinity over the overlapping image. The above windows display six examples of such correlation surfaces for translations in a square region with the origin in the middle. The PMCC coefficnet r is grey-coded in the range from -0.7 to 0.7. The candidate for the translational offset is the translation with maximal r. Candidates are rejected if either r was too low (not similar), there was more than one maximum with very similar r (ambiguous), the maximum is not well localized in both dimensions (an edge pattern that fits everywhere alongside the edge). ]]
Corresponding locations are searched through block matching.  Initialized from an approximate linear pairwise alignment that is estimated using [[Feature Extraction|local image features]].
