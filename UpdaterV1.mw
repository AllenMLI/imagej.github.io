= Updater V1 technical details =

I'll use this page to document the changes made to the ImageJ Updater in the about to be released version called V1.

== What's different ==
* Added a check whether Java supports the HTTPS certificate of the imagej.net server
* Depending on what's supported, the updater will use HTTPS or HTTP links for the update sites on imagej.net (and throw a warning in case HTTPS is not supported)
* Uploading via HTTPS is working now, both basic and digest authentication supported
* The updater is smarter about updating URLs of official sites (= listed on the list of available update sites) in case they change remotely
* There is an interface to review updates to the URLs of active update sites

== UpdateSite URL representation ==
[[http://www.plantuml.com/plantuml/uml/ZPB1Ri8m38RlVGehfp6Dmwu88T2aIMXZI4CyW6bSbYrDeZHbGjh3pnrTIscAEDNz_o-_xJRp8g0FPQuJPGBv35C2iUGATvgcpqhJUlT9QPY992x3z6SyXaefdgpMh2bhaejt48y2B7CYHtCKi7KI0srKeAGj_w3x2kBdeWmsPqDktrzFI2zp0YjqqqtmokmVpY9dK3PrSPu_WHCC1dEA6gNNNNrdhIOqWDpoG77FPfbA5GwS_29olCFAIiKOLfDtmVwcW3sfUwIWmCvTE_Ievo-CVE7EbrYaMJkgeM-M5yvvUo0PP-km2lKwZd3tDxPlwVo1HOqE07iArm5qJXzlG9RP_rv3MFMZrbfU2LBriF6ao0TemEOQrS8ecPEHPQv_0G00 src]]
[[File:FilesCollectionClass.png]]

== Manually add update site and edit URL ==
 [[http://www.plantuml.com/plantuml/uml/VP0n3i8m34NtdC8N20T0K5K2CS42wW6inYgMJ8eQP-3sE7H9Cx3yuUUzdoXzKbmqlyGfgn3SC6OK-G260FaTK0aIMs0CG84LXliLtCEgT6QKUGBVmOM5qcaMeL5vZh0l-l2p2-d6XSfGrRI6xwfJyrUZlMU3959xYwkwbj0dfrrU18vW-NTiMiTgvE3zbYaRFSLWl_K5 src]]
[[File:PersonalSiteSequence.png]]

== Update Check on Startup ==
* this is the `onEvent` Method of the `DefaultUpdateService` which is called when the ImageJ UI is shown 
[[http://www.plantuml.com/plantuml/uml/bPDHZfmm44J_EGKNc0j4KRG4FDfHl8309CeNSaolnbhZHdP3hXyJJqPXLeZaawhgHnSsJvwaetaq2Maoa7RJ80dI_0hgBKMRjh_jAIdWLSw6ejs2MxI2zFGf1i_eek7J3wcRRVAeXc0t2Ip2GqYerKsa8hq4uUuazyWsRc41ry2exV0E_F5q-ZkQFxFyIo-wfcH5NvtFUqX_nTaCaSc3v8x03Nkvb4NFCy6QFQYIzflJ1CUiB2nNykzx8ErhXmIAOE2e96cqHyowgGJBHMZDgpmJbwhSXnUmWC7fk7J1lZ9UrVkDhtA14kWdkhSShGNrBwk6O-6NaYNAmIgSjG6Vep5nUlEg1oyCnw63KCWCcyZwEL6XwKYRF_VlMOYwRUTfGaURSBP8RUGF0wsE5_egVQoo2bt3RxsEUdPraGcMVUPiWx-Zuc5mwUa51_sgOVWFeWEQdGrABwf-LT_DnjhZH9q79p3Ajz_pmTXivhhBBVK4TfX7ymi0 src]]
[[File:UpdateCheckStartupSequence.png]]

== ImageJUpdater implements UpdaterUI ==
* called from startup in case there are updates available (see last line in previous diagram)
* called via Help > Update...
[[http://www.plantuml.com/plantuml/uml/fLJ1Rjim3BtxAtHiWUG7Xc6eqQ5Ojc8hcdftrg8zehGaY7IoxkkdEFKCs-tiOKUHxpq-YfIkH25gst2cf8ncrq2DdujWGJ4QQW9ZWqx5l8IAdRcGKvWgGdkPZV7R3nE1TqPyWoP43ARyWUMJP06YKaa1dFQYDn4Q72NkebTVUYwKU9J83q0CZunxKfIiZ0YAveOOvTepOwdatSpL591ydPczmCZ8b3tA3jGLHJG-ttgmvEeXF2hPjP5DYKbhoCwyvgtw1XHjSNzxXcK3Ed7dWB-O7jrqWdL3-lJmSBVVjo7ug8iCEUEa8qtGxxVR6HpBDkBotXmXEaEL8VSMOxmAYLBHpnUGOEo2VUriZ7tpaWJrAnwBo2kgaICbOFg5kREvjLryNcY-5QUk71ut1gmT1hVMOYA7Y89EpMEh9gNIpC3LQ3U3_NvLxl50U3m99fny961Vprfx5JLip6lPXGjCaJo4w0zeBofWmSl_LT7O_gl84sBungTGDi_FdfYWVac415WnUWY1dxl37q5PEx-EkwlwpbPwIyar_qr4zc27KExiTVVhjitoYqjRP1cxXqUkbeqflQkOIfN57r5GlvDGQZwxGcVRXdy3 src]]
[[File:ImageJUpdaterSequence.png]]

== Command line usage ==
<source>ImageJ --update refresh-update-sites --simulate</source>
<source>ImageJ --update refresh-update-sites</source>
<source>ImageJ --update refresh-update-sites --updateall</source>
<source>ImageJ --update refresh-update-sites --keepall</source>

== Relevant PRs / issues ==
* [https://github.com/imagej/imagej-updater/issues/70 Issue for new updater]
* [https://github.com/imagej/imagej-updater/issues/66 Update cached update site links issue]
* [https://github.com/imagej/imagej-updater/pull/67 Support redirects PR] 
* [https://github.com/imagej/imagej-updater/pull/71 V1 imagej-updater PR]
* [https://github.com/imagej/imagej-ui-swing/pull/81 V1 imagej-swing-ui PR]
* [https://github.com/imagej/imagej-plugins-uploader-webdav/pull/3 V1 imagej-plugins-uploader-webdav PR]
