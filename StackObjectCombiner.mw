== Stack Object Combiner ==
Because of the cubic cost of the 3D segmentation (in memory and processing) with [http://ilastik.org/ Ilastik], it is not possible to work on full stacks of EM images in once.<br/>
To be fully segmented, the stack need to be cut in parts. But this operation will cut some objects in 2 or more parts, and the objects will lost the coordinate system of the original stack.<br/>
The purpose of this plugin is to replace the objects in their original position, and provide a tool that will allow a user to merge 3D objects that have been cut.

== Installation ==
The plugin can be found on the github [https://github.com/Tom-TBT/StackObjectCombiner/releases project] in the release tab (please take the lattest version of the plugin). <br/>
Download the .jar file and place it in the plugin folder of ImageJ. <br/>
This plugin also need the 
[https://mvnrepository.com/artifact/org.apache.commons/commons-math3 apache common maths] librairy. If you use Fiji, this librairy is already included. If you use ImageJ, download the lattest version and put the .jar file into ImageJ/plugins/jars/

== Presentation of the interface ==

[[File:SOC_Window.png|1000px|center]]

Here is the Interface of Stack Object Combiner. The window contain several boxes, that allow you to set the different parameters and that give you an overview of the meshes.<br/><br/>

[[File:SOC_folderSelection.png]] Folder selection box<br/>This is the Folder Box. Choose the folder containing your meshes. To work only with certain meshes inside this folder, use the "Name pattern" function. Write the characters that the file contains, and click on "Actualise". The pattern can be a [https://en.wikipedia.org/wiki/Regular_expression regular expression]. <br/>Finally "Actualise" allow you to refresh the folder, for example if you have deleted or added files.

[[File:SOC_shift.png]] Shift box<br/>
In the shift box, set the positions and dimensions of the cubes. To shift the meshes at their coordinates in the reconstructed volume, give the values of the shift in X, Y and Z. (See the illustration bellow to see to what each value correspond). X, Y and Z correspond respectively to the width, height and depth of the stack A (don't confuse the width, height and depth of the whole volume that you also have to give here, with the width, height and depth of the volume A that match the values of Shift X, Y and Z).<br/>
Once these values are set, click on "Shift" to shift all the meshes listed. To shift back the mesh to their original positions, click on "Unshift".<br/>
The values you give here will be used later to merge the meshes. For automatic merging, you have to give the width, height and depth of the whole volume.
[[File:SOC_cubeDimensions.png|400px]] [[File:SOC_cubeSplitting.png|500px]]

[[File:SOC_meshes.png]] Meshes listing<br/>

== Example ==

During this example, you can look at the different step with the [http://fiji.sc/3D_Viewer 3DViewer], or with [https://www.blender.org/ Blender].
<ol>
<li>Download the meshes of a mitochondria in the shape of a donut divided in 4 parts [[Media:MitoDonut Meshes.zip]]</li>
<li>Launch the plugin, and give the directory containing the .obj file</li>
<li>X shift : 192 &nbsp;&nbsp;&nbsp;Y shift : 214</li>
<li>Click on the Shift button to shift the meshes.</li>
<li>Now merge the meshes two by two. Select them and use the Merge button.</li>
<li>Merge then the two resulting meshes. Note that your meshes should start with names that correspond to neighbors sub-stacks (E.g. A_ & C_)</li>
<li>Look at the result</li>
</ol>

== Reference ==

This plugin haven't been published yet, but if you want to cite you can always refer to it as 
T. Boissonnet,"Stack Object Combiner plugin for ImageJ", http://imagej.net/StackObjectCombiner, October 2015

== Contact ==

For any suggestions, questions, problems or just to give feedback, please feel free to contact Tom Boissonnet at tom.boissonnet@hotmail.fr 

== Licence ==

This program is '''free software'''; you can redistribute it and/or modify it under the terms of the '''GNU General Public License''' as published by the Free Software Foundation ([http://www.gnu.org/licenses/gpl.txt http://www.gnu.org/licenses/gpl.txt]).

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.

== Futur improvements ==

The plugin is still in development. We intend to improve the plugin by adding parameters to the plugin and an automatic pairing of borders. Any suggestion is welcome.
