---
autogenerated: true
title: Deconvolution
section: Learn:Techniques
---

{% include notice icon='info' size='large' content='See the [plugin-index](/plugin-index#deconvolution) for pages about deconvolution.' %} 
{% include wikipedia title='Deconvolution' text='Deconvolution'%} corrects the systematic error of blur (loss of contrast in smaller features) in optical systems such as fluorescence microscopy images.

## The problem, and the solution

Any optical image forming system, such as a microscope objective lens, has the nasty property of killing more and more contrast of smaller and smaller features, up to the resolution (diffraction) limit, after which there is no contrast (and thus no resolution). Large features are bright, but small features appear less contrasted and dimmer than they should. This is a systematic error, characterized by the Point Spread Function (PSF) of the optical system, which makes the image intensity information non-quantitative. If we can measure the PSF, or guess it, we can correct the raw image for it. Since it's possible to correct such a systematic error, we should!

Image contrast restoration by deconvolution is a way to correct the systematic error of contrast loss in an image recording system, such as a microscope objective lens or telescope mirror or lens. We try to reverse the effects of blur in the recorded image, caused by convolution (blur, smearing, loss of contrast of small features) of the real image due to the imaging point spread function (PSF).

Image contrast restoration by deconvolution is an important systematic error correction step for quantitative measurement of image pixel intensities in analysis workflows. If we don't correct this systematic error, the results of the image intensity analysis could be very much more wrong than if we correct the images before analysis. It's the same as zeroing a scale before weighing something.

## Introduction to the practical method

Two plugins from Bob Dougherty can be used together to perform this systematic error correction in a 2D or 3D image. Other plugins are also available. The Diffraction-PSF-3D plugin generates a z-stack of the theoretical point-spread function (PSF). Alternatively, an empirical, measured PSF could be used. The Iterative Deconvolution 3D plugin uses a PSF image z-stack to correct the image contrast vs. feature size in your sample image z-stack. The image below is a single slice taken from a stack before and after deconvolution using these plugins.

![](/media/cookbook/deconvoluted-data.png)

*See the plugins' homepages for more details:* [Diffraction PSF 3D](http://www.optinav.info/Diffraction-PSF-3D.htm) & [Iterative Deconvolution 3D](http://www.optinav.info/Iterative-Deconvolve-3D.htm)

## Generating a PSF image stack

The Diffraction PSF 3D plugin can be used to generate theoretical PSFs assuming they arise only from diffraction. These PSFs may be used with other deconvolution plugins later.

To use, run the "Diffraction PSF 3D" plugin. A dialog will appear; most of the fields are self explanatory. The width, height and depth values are for the PSF image, not your image stack. The desired values will need to be empirically determined. Try to match the parameters used to capture the raw image.

{% include img src="diffraction-psf-window1" width="377" height="317" %}

## Constrained Iterative Deconvolution

Non negative constrained (non linear), iterative deconvolution algorithms greatly outperform simple inverse filters and Wiener filters on noisy real life fluorescence microscopy (and other) image data.

Run the Iterative Deconvolve 3D plugin, then select the image and PSF. For a 2D image, use a 2D (single plane) PSF. For 3D images, use a 3D PSF (z stack). Start with the default values and set iterations to 10 initially. Be careful not to run out of memory when processing large 3D images. Crop them if they are too large.

{% include img src="iterative-deconvolve-window" width="411" height="272" %}

## An interactive Convolution / Deconvolution / Contrast Restoration demo in ImageJ

For an educational interactive ImageJ javascript demo of convolution, inverse filtering and image contrast restoration by iterative constrained deconvolution (using the above plugins), see this [Convolution / Deconvolution / Contrast Restoration demo script](https://github.com/chalkie666/imagejMacros/blob/master/DeconvolutionDemos/Convolution_Deconvolution_Demo.js)

## Video presentations

<!-- TODO: Convert to a proper (but flexible) grid of some sort. -->

<div style="display: inline-block; width: 49%; min-width: 300px; vertical-align: top">

{% capture bnorthan-footer -%}
[Flexible deconvolution using ImageJ Ops](https://vimeo.com/140098821)
by {% include person id='bnorthan' %} ([slides](/presentations/2015-09-04-imagej2-deconvolution/))
{%- endcapture -%}
{% include video platform='vimeo' id='140098821' aspect='16:9' footer=bnorthan-footer %}

</div>

<div style="display: inline-block; width: 49%; min-width: 300px; vertical-align: top">

{% capture bene51-footer -%}
[Real-time multi-view deconvolution of time-lapse data on the GPU](https://vimeo.com/140098826)
by {% include person id='bene51' %}
{%- endcapture -%}
{% include video platform='vimeo' id='140098826' aspect='16:9' footer=bene51-footer %}

</div>
