
== Anomalous Diffusion Filters ==

A PlugInFilter for the two different methods for image filtering: Anisotropic Anomalous Diffusion and Isotropic Anomalous Diffusion. Both methods description can be found in the Physics in Medicine and Biology article [http://] and have a discrete solution of generalized diffusion heat equation (also know as a porous media equation). 

In summary, the anomalous diffusion filters are generalized methods that are proposed using the new anomalous distribution probability function (PDF) paradigm, also called ''q-Gaussian'' PDF. These new filters are capable to build both classic and anomalous diffusion process, which is related to the anomalous parameter, called q value. When q=1 it returns the classic diffusion methods, both anisotropic diffusion (Perona and Malik method) and Gaussian filter (usual Gaussian filter widely knows in several filtering applications). On the contrary, when q â‰  1 the anomalous diffusion filters uses the q-Gaussian probability distribution to attenuate the local noise present in each neighborhood around each pixel of the image.

'''Update notes:'''

*''Feb-01-2015'': The methods are capable to process image stacks, however, all the filtering method still is performed in bidimensional images.

== Anomalous Diffusion Analytic Description ==

Anomalous diffusion processes (ADP) are mathematically denoted by a power law in the Fokker-Planck equation, leading to the generalized form. There are several generalizations of the Fokker-Plank equation, which should give many different partial differential equations (PDEs). Here we adopt only the so called porous media form, allowing the super-diffusive and the sub-diffusive processes. In porous media, channels are created promoting or blocking the flow of the density function. Equation (\ref{Eq:FokkerPlanckGeneralized}) shows the generalized heat flow equation that is the main PDE equation for the anomalous diffusion paradigm.    

<math>
\frac{\partial\rho}{\partial t} =   \overrightarrow{\nabla}[D_q .\overrightarrow{\nabla} \rho]^{2-q}
</math>

Where <math>\rho</math> represents diffusing element concentration, <math>D_q</math> denotes the generalized diffusion coefficient and $q$ is the power law parameter conveniently written. When <math>q=1</math>, the porous media equation recovers the classical diffusion, for <math>q<1</math> it represents sub-diffusive process, and when <math>q>1</math> it means super-diffusive phenomena are present. The <math>D_q</math> is the diffusion coefficient function that regulates diffusibility. We can distinguish <math>D_q</math> function in isotropic: when the diffusion coefficient is the same for all direction, i.e. <math>D_q</math> is direction invariant; and anisotropic behavior: when diffusion is driven to specific directions. The definition of isotropy or anisotropy is directly related to <math>D_{q}</math> function, which is the spatial function that regulates the filter blurring effect at each point.

=== Generalized diffusion coefficient function ===

The generalized diffusion coefficient value, <math>D_q</math>, must be consistent with ADP so that it can be used in IAD and AAD filters. The analytical form for <math>D_q</math> must be consistent with the ADP time evolution of variance, which follows <math>\sigma^{2} = 2.D_q.t</math>, i.e. linear relationship for classical diffusion, and <math>\sigma^{2} \propto t^{2/(3-q)}</math>, i.e nonlinear relationship for ADP.

=== Filter's Description ===

Proposed IAD and AAD filters are based on iterative numerical algorithms for ADP. The method used to solve partial differential anomalous equations uses finite differences, of first and second order, when time and space becomes discrete, i.e. digital images. Both isotropic and anisotropic approaches were implemented through numerical differential operators using explicit numeric formulation, similar to classic anisotropic diffusion filter (purposed by Perona and Malik).

Numerical approaches were implemented using differential operators in one dimension, and then rotated in eight angle directions with respect to the central reference pixel. We can express this rotation in follow equation. 

<math>
 I_{\phi,t+1} = I_{\phi,t} + \lambda.\overrightarrow{\nabla} \Big[ D_q. \overrightarrow{\nabla} I_{\phi,t}^{2 - q} \Big]
</math>

Where <math>I_{\phi,t}</math> and <math>I_{\phi,t+1}</math> are the evaluated images in <math>t_i</math> iterations, and <math>I_{\phi,0}</math> is the original image. <math>D_{q}</math> is the diffusion coefficient regulated by a power law with <math>\textit{q}</math>, and <math>\phi</math> are the possible orientations with respect to the central pixel. The equation above assumes the time step is a constant (<math>\lambda \propto \Delta t/\Delta x^2</math>) and it depends on the numerical discretization. A careful time step determination plays an important role for numerical stability. The time step determination have a direct influence on the numeric discretization of the diffusion equation and here it follows the same assumptions made for the classical anisotropic diffusion algorithm. More details about the time step parameters and numerical stability can be found in [http://imagej.net/User:Acsenrafilho references section] of the CSIM main wiki site.

== Filters parameters ==

=== Anisotropic Anomalous Diffusion Filter ===


=== Isotropic Anomalous Diffusion Filter ===
[[Image:Filters-parameters.png|thumb|300px|Filter's parameters for both isotropic and anisotropic approaches.]]
