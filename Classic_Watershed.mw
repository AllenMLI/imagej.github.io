{{Infobox
| name                   = Classic Watershed
| software               = ImageJ/Fiji
| author                  = [[User:Iarganda | Ignacio Arganda-Carreras]], David Legland
| maintainer             = [[User:Iarganda | Ignacio Arganda-Carreras]]
| source                 = {{GitHub|org=ijpb|repo=ijpb-plugins}}
| released               = July 3<sup>rd</sup>, 2014
| latest version         = September 15<sup>th</sup>, 2014 (ijpb-plugins 1.0.4)
| status                 = stable, active
| category               = [[:Category:Segmentation|Segmentation]]
}}{|
|style="vertical-align:top" |[[Image:Classic-Watershed-lines-blur-blobs.png|thumb|300px|Overlay of watershed lines on blurred blobs.]]
|}

== Introduction ==
[[Image:Watershed-flooding-graph.png|thumb|250px|right|Schematic overview of watershed flooding in 1D]]Classic Watershed is an ImageJ/Fiji plugin to perform watershed segmentation of grayscale 2D/3D images using flooding simulations as described by Pierre Soille and Luc M. Vincent (1990).


The basic idea consists of considering the input image as topographic surface and placing a water source in each regional minimum of its relief. Next the entire relief is flooded from the sources and dams are placed where the different water sources meet.

All points in the surface at a given minimum constitute the '''catchment basin''' associated with that minimum. The '''watersheds''' are the zones dividing adjacent catchment basins.

The first image points that are reached by water are the points at the lowest grayscale value <math>h_{min}</math>, then all image pixels are progressively reached up to the highest level <math>h_{max}</math>.

== Usage ==
The Classic Watershed plugin runs on any '''grayscale image (8, 16 and 32-bit) in 2D and 3D'''. 

At least one image needs to be open in order to run the plugin. 

[[Image:Classic-Watershed-dialog.png|thumb|Main dialog of the Classic Watershed plugin]]
Image parameters:
* '''Input''' image: grayscale image to flood, usually the gradient of an image.
* '''Mask''' image (optional): binary image of the same dimensions as the input image which can be used to restrict the areas of application of the algorithm. Set to "None" to run the method on the whole input image.

Morphological parameters:
* '''Use diagonal connectivity''': select to allow the flooding in diagonal directions (8-connectivity in 2D and 26-connectivity in 3D).
* '''Min h''': minimum grayscale value to start flooding from.
* '''Max h''': maximum grayscale value to reach with flooding.

== Installation ==

The Classic Watershed plugin is part of the IJPB-plugins library. To install it, you just need to [[How_to_follow_a_3rd_party_update_site#Add_update_sites | add]] the IJPB-plugins update site:

1) Select ''Help > Update...'' from the Fiji menu to start the updater.

2) Click on ''Manage update sites''. This brings up a dialog where you can activate additional update sites.

3) Activate the IJPB-plugins update site and close the dialog. Now you should see an additional jar file for download.

4) Click ''Apply changes'' and restart Fiji.

You should now find the plugin under the sub-menu ''Plugins > Segmentation''.

'''Note''': Classic Watershed is only one of the plugins included in the IJPB-plugins suite. By following these installation steps, you will be installing as well the rest of plugins in the suite.

== References ==
# Pierre Soille and Luc M. Vincent. "Determining watersheds in digital pictures via flooding simulations." Lausanne-DL tentative. International Society for Optics and Photonics, 1990.
== See also ==
* [[Marker-controlled Watershed]], a plugin to perform watershed by flooding from specific seed points or markers.
* [[Morphological Segmentation]], a plugin with a graphical user interface to segment images based on morphological operations and the watershed algorithm.

== License ==
This program is '''free software'''; you can redistribute it and/or modify it under the terms of the '''GNU General Public License''' as published by the Free Software Foundation ([http://www.gnu.org/licenses/gpl.txt http://www.gnu.org/licenses/gpl.txt]).

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details. 

[[Category:Plugins]]
[[Category:Segmentation]]
